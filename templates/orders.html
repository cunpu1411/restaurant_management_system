{% extends "base.html" %}

{% block title %}Orders Management - Restaurant Management System{% endblock %}

{% block extra_css %}
<style>
    .status-badge {
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
    }
    .order-card {
        transition: transform 0.2s;
    }
    .order-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .order-summary {
        font-size: 0.9rem;
    }
    .timeline-item {
        position: relative;
        padding-left: 30px;
        margin-bottom: 15px;
    }
    .timeline-item:before {
        content: '';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 15px;
        height: 15px;
        border-radius: 50%;
        background-color: #007bff;
    }
    .timeline-item:after {
        content: '';
        display: block;
        position: absolute;
        left: 7px;
        top: 15px;
        width: 2px;
        height: calc(100% + 5px);
        background-color: #dee2e6;
    }
    .timeline-item:last-child:after {
        display: none;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Orders Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3">Orders Management</h1>
        <div class="btn-toolbar">
            <button class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#newOrderModal">
                <i class="bi bi-plus-circle"></i> New Order
            </button>
            <div class="dropdown">
                <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="orderFilterDropdown" data-bs-toggle="dropdown">
                    Filter: All Orders
                </button>
                <ul class="dropdown-menu" aria-labelledby="orderFilterDropdown">
                    <li><a class="dropdown-item active" href="#" data-filter="all">All Orders</a></li>
                    <li><a class="dropdown-item" href="#" data-filter="pending">Pending</a></li>
                    <li><a class="dropdown-item" href="#" data-filter="processing">Processing</a></li>
                    <li><a class="dropdown-item" href="#" data-filter="completed">Completed</a></li>
                    <li><a class="dropdown-item" href="#" data-filter="cancelled">Cancelled</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Order Tabs -->
    <ul class="nav nav-tabs mb-4" id="orderTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="all-orders-tab" data-bs-toggle="tab" data-bs-target="#all-orders" type="button" role="tab" aria-controls="all-orders" aria-selected="true">
                All Orders <span class="badge bg-secondary">12</span>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="pending-tab" data-bs-toggle="tab" data-bs-target="#pending" type="button" role="tab" aria-controls="pending" aria-selected="false">
                Pending <span class="badge bg-warning">3</span>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="processing-tab" data-bs-toggle="tab" data-bs-target="#processing" type="button" role="tab" aria-controls="processing" aria-selected="false">
                Processing <span class="badge bg-info">4</span>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="completed-tab" data-bs-toggle="tab" data-bs-target="#completed" type="button" role="tab" aria-controls="completed" aria-selected="false">
                Completed <span class="badge bg-success">5</span>
            </button>
        </li>
    </ul>

    <!-- Search and Date Filter -->
    <div class="card shadow mb-4">
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                        <input type="text" class="form-control" id="searchOrders" placeholder="Search orders...">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text">Date Range</span>
                        <input type="date" class="form-control" id="startDate">
                        <span class="input-group-text">to</span>
                        <input type="date" class="form-control" id="endDate">
                    </div>
                </div>
                <div class="col-md-2">
                    <button type="button" class="btn btn-outline-primary w-100">Apply Filter</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Orders Tab Content -->
    <div class="tab-content" id="orderTabsContent">
        <!-- All Orders Tab -->
        <div class="tab-pane fade show active" id="all-orders" role="tabpanel" aria-labelledby="all-orders-tab">
            <div class="row">
                <!-- Order Card 1 -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card order-card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><a href="/orders/1001">#1001</a></h5>
                            <span class="badge bg-warning status-badge">Processing</span>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="mb-1"><strong>Table:</strong> Table 4</div>
                                <div class="mb-1"><strong>Waiter:</strong> John Smith</div>
                                <div><strong>Time:</strong> <span class="text-muted">Today, 10:45 AM</span></div>
                            </div>
                            <div class="order-summary mb-3">
                                <div><strong>Items:</strong></div>
                                <ul class="list-unstyled ms-3 mb-0">
                                    <li>1 × Grilled Salmon</li>
                                    <li>2 × Fresh Orange Juice</li>
                                    <li>1 × Chocolate Cake</li>
                                </ul>
                            </div>
                            <div class="text-end mb-3">
                                <strong>Total:</strong> <span class="fs-5">$45.80</span>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="/orders/1001" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Card 2 -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card order-card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><a href="/orders/1002">#1002</a></h5>
                            <span class="badge bg-success status-badge">Completed</span>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="mb-1"><strong>Table:</strong> Table 2</div>
                                <div class="mb-1"><strong>Waiter:</strong> Maria Johnson</div>
                                <div><strong>Time:</strong> <span class="text-muted">Today, 11:20 AM</span></div>
                            </div>
                            <div class="order-summary mb-3">
                                <div><strong>Items:</strong></div>
                                <ul class="list-unstyled ms-3 mb-0">
                                    <li>2 × Beef Steak</li>
                                    <li>1 × Cheese Platter</li>
                                    <li>2 × Fresh Orange Juice</li>
                                </ul>
                            </div>
                            <div class="text-end mb-3">
                                <strong>Total:</strong> <span class="fs-5">$78.25</span>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="/orders/1002" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Card 3 -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card order-card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><a href="/orders/1003">#1003</a></h5>
                            <span class="badge bg-info status-badge">Pending</span>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="mb-1"><strong>Table:</strong> Table 7</div>
                                <div class="mb-1"><strong>Waiter:</strong> Robert Davis</div>
                                <div><strong>Time:</strong> <span class="text-muted">Today, 12:15 PM</span></div>
                            </div>
                            <div class="order-summary mb-3">
                                <div><strong>Items:</strong></div>
                                <ul class="list-unstyled ms-3 mb-0">
                                    <li>1 × Grilled Salmon</li>
                                    <li>1 × Fresh Orange Juice</li>
                                </ul>
                            </div>
                            <div class="text-end mb-3">
                                <strong>Total:</strong> <span class="fs-5">$28.50</span>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="/orders/1003" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Card 4 -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card order-card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><a href="/orders/1004">#1004</a></h5>
                            <span class="badge bg-success status-badge">Completed</span>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="mb-1"><strong>Table:</strong> Table 1</div>
                                <div class="mb-1"><strong>Waiter:</strong> Sarah Brown</div>
                                <div><strong>Time:</strong> <span class="text-muted">Today, 12:30 PM</span></div>
                            </div>
                            <div class="order-summary mb-3">
                                <div><strong>Items:</strong></div>
                                <ul class="list-unstyled ms-3 mb-0">
                                    <li>1 × Beef Steak</li>
                                    <li>1 × Cheese Platter</li>
                                    <li>1 × Chocolate Cake</li>
                                    <li>1 × Fresh Orange Juice</li>
                                </ul>
                            </div>
                            <div class="text-end mb-3">
                                <strong>Total:</strong> <span class="fs-5">$52.30</span>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="/orders/1004" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Order Card 5 -->
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="card order-card shadow-sm">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><a href="/orders/1005">#1005</a></h5>
                            <span class="badge bg-danger status-badge">Cancelled</span>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <div class="mb-1"><strong>Table:</strong> Table 3</div>
                                <div class="mb-1"><strong>Waiter:</strong> Michael Wilson</div>
                                <div><strong>Time:</strong> <span class="text-muted">Today, 1:15 PM</span></div>
                            </div>
                            <div class="order-summary mb-3">
                                <div><strong>Items:</strong></div>
                                <ul class="list-unstyled ms-3 mb-0">
                                    <li>1 × Chocolate Cake</li>
                                </ul>
                            </div>
                            <div class="text-end mb-3">
                                <strong>Total:</strong> <span class="fs-5">$12.99</span>
                            </div>
                            <div class="d-grid gap-2">
                                <a href="/orders/1005" class="btn btn-outline-primary">View Details</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <nav aria-label="Page navigation">
                <ul class="pagination justify-content-center">
                    <li class="page-item disabled">
                        <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                    </li>
                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#">Next</a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Other Tabs (Pending, Processing, Completed) would have similar content -->
        <div class="tab-pane fade" id="pending" role="tabpanel" aria-labelledby="pending-tab">
            <!-- Similar content as All Orders but filtered for Pending status -->
            <div class="text-center text-muted py-5">
                <p>Pending orders will be displayed here.</p>
            </div>
        </div>
        
        <div class="tab-pane fade" id="processing" role="tabpanel" aria-labelledby="processing-tab">
            <!-- Similar content as All Orders but filtered for Processing status -->
            <div class="text-center text-muted py-5">
                <p>Processing orders will be displayed here.</p>
            </div>
        </div>
        
        <div class="tab-pane fade" id="completed" role="tabpanel" aria-labelledby="completed-tab">
            <!-- Similar content as All Orders but filtered for Completed status -->
            <div class="text-center text-muted py-5">
                <p>Completed orders will be displayed here.</p>
            </div>
        </div>
    </div>
</div>

<!-- New Order Modal -->
<div class="modal fade" id="newOrderModal" tabindex="-1" aria-labelledby="newOrderModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="newOrderModalLabel">Create New Order</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="newOrderForm" class="needs-validation" novalidate>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label for="orderTable" class="form-label">Table</label>
                            <select class="form-select" id="orderTable" required>
                                <option value="">Select a table</option>
                                <option value="1">Table 1</option>
                                <option value="2">Table 2</option>
                                <option value="3">Table 3</option>
                                <option value="4">Table 4</option>
                                <option value="5">Table 5</option>
                                <option value="6">Table 6</option>
                                <option value="7">Table 7</option>
                                <option value="8">Table 8</option>
                                <option value="9">Table 9</option>
                                <option value="10">Table 10</option>
                            </select>
                            <div class="invalid-feedback">Please select a table.</div>
                        </div>
                        <div class="col-md-6">
                            <label for="orderWaiter" class="form-label">Waiter</label>
                            <select class="form-select" id="orderWaiter" required>
                                <option value="">Select a waiter</option>
                                <option value="1">John Smith</option>
                                <option value="2">Maria Johnson</option>
                                <option value="3">Robert Davis</option>
                                <option value="4">Sarah Brown</option>
                                <option value="5">Michael Wilson</option>
                            </select>
                            <div class="invalid-feedback">Please select a waiter.</div>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-12">
                            <label for="orderCustomer" class="form-label">Customer (Optional)</label>
                            <div class="input-group">
                                <select class="form-select" id="orderCustomer">
                                    <option value="">Select a customer</option>
                                    <option value="1">John Doe</option>
                                    <option value="2">Jane Smith</option>
                                    <option value="3">Robert Johnson</option>
                                </select>
                                <button class="btn btn-outline-secondary" type="button" data-bs-toggle="collapse" data-bs-target="#newCustomerForm">
                                    <i class="bi bi-plus"></i> New
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="collapse mb-3" id="newCustomerForm">
                        <div class="card card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <label for="customerName" class="form-label">Customer Name</label>
                                    <input type="text" class="form-control" id="customerName">
                                </div>
                                <div class="col-md-6">
                                    <label for="customerPhone" class="form-label">Phone Number</label>
                                    <input type="tel" class="form-control" id="customerPhone">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <h6>Order Items</h6>
                    <div id="orderItems">
                        <div class="row mb-3 align-items-end order-item">
                            <div class="col-md-5">
                                <label for="item1" class="form-label">Item</label>
                                <select class="form-select" id="item1" required>
                                    <option value="">Select an item</option>
                                    <option value="1">Grilled Salmon - $18.99</option>
                                    <option value="2">Beef Steak - $22.99</option>
                                    <option value="3">Cheese Platter - $10.99</option>
                                    <option value="4">Chocolate Cake - $7.99</option>
                                    <option value="5">Fresh Orange Juice - $4.99</option>
                        </select>
                        <div class="invalid-feedback">Please select an item.</div>
                    </div>
                    <div class="col-md-2">
                        <label for="quantity${itemCount}" class="form-label">Quantity</label>
                        <input type="number" class="form-control" id="quantity${itemCount}" min="1" value="1" required>
                        <div class="invalid-feedback">Quantity must be at least 1.</div>
                    </div>
                    <div class="col-md-4">
                        <label for="specialRequest${itemCount}" class="form-label">Special Request</label>
                        <input type="text" class="form-control" id="specialRequest${itemCount}" placeholder="Optional">
                    </div>
                    <div class="col-md-1">
                        <button type="button" class="btn btn-outline-danger remove-item">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                `;
                
                orderItems.appendChild(newItem);
                
                // Add event listener to new remove button
                const removeButtons = document.querySelectorAll('.remove-item');
                removeButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        if (document.querySelectorAll('.order-item').length > 1) {
                            this.closest('.order-item').remove();
                            updateOrderTotal();
                        }
                    });
                });
            });
        }
        
        // Calculate order total
        function updateOrderTotal() {
            // In a real implementation, this would calculate the actual total based on selected items
            document.getElementById('orderTotal').textContent = '$45.80';
        }
        
        // Show order detail modal when clicking "View Details"
        const viewDetailLinks = document.querySelectorAll('a[href^="/orders/"]');
        viewDetailLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const orderId = this.getAttribute('href').split('/').pop();
                
                // Update modal title with order ID
                document.getElementById('orderDetailModalLabel').textContent = `Order #${orderId} Details`;
                
                // Show the modal
                const orderDetailModal = new bootstrap.Modal(document.getElementById('orderDetailModal'));
                orderDetailModal.show();
            });
        });
        
        // Form validation
        const forms = document.querySelectorAll('.needs-validation');
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                } else {
                    // For demo purposes, prevent actual form submission
                    event.preventDefault();
                    
                    // Show success message or redirect in a real implementation
                    if (form.id === 'newOrderForm') {
                        alert('Order created successfully!');
                        const modal = bootstrap.Modal.getInstance(document.getElementById('newOrderModal'));
                        modal.hide();
                    }
                }
                form.classList.add('was-validated');
            }, false);
        });
    });
</script>
{% endblock %}
                                </select>
                                <div class="invalid-feedback">Please select an item.</div>
                            </div>
                            <div class="col-md-2">
                                <label for="quantity1" class="form-label">Quantity</label>
                                <input type="number" class="form-control" id="quantity1" min="1" value="1" required>
                                <div class="invalid-feedback">Quantity must be at least 1.</div>
                            </div>
                            <div class="col-md-4">
                                <label for="specialRequest1" class="form-label">Special Request</label>
                                <input type="text" class="form-control" id="specialRequest1" placeholder="Optional">
                            </div>
                            <div class="col-md-1">
                                <button type="button" class="btn btn-outline-danger remove-item">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mb-3">
                        <button type="button" class="btn btn-outline-primary" id="addItemBtn">
                            <i class="bi bi-plus-circle"></i> Add Item
                        </button>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="text-end mb-3">
                        <h5>Total: <span id="orderTotal">$0.00</span></h5>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="newOrderForm" class="btn btn-primary">Create Order</button>
            </div>
        </div>
    </div>
</div>

<!-- Order Detail Modal (would be shown when clicking "View Details") -->
<div class="modal fade" id="orderDetailModal" tabindex="-1" aria-labelledby="orderDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="orderDetailModalLabel">Order #1001 Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6>Order Information</h6>
                        <table class="table table-sm">
                            <tr>
                                <th>Order ID:</th>
                                <td>#1001</td>
                            </tr>
                            <tr>
                                <th>Date:</th>
                                <td>April 6, 2025</td>
                            </tr>
                            <tr>
                                <th>Time:</th>
                                <td>10:45 AM</td>
                            </tr>
                            <tr>
                                <th>Status:</th>
                                <td><span class="badge bg-warning">Processing</span></td>
                            </tr>
                            <tr>
                                <th>Table:</th>
                                <td>Table 4</td>
                            </tr>
                            <tr>
                                <th>Waiter:</th>
                                <td>John Smith</td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <h6>Customer Information</h6>
                        <table class="table table-sm">
                            <tr>
                                <th>Name:</th>
                                <td>Walk-in Customer</td>
                            </tr>
                        </table>
                        
                        <h6 class="mt-4">Order Timeline</h6>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="fw-bold">Order Created</div>
                                <div class="text-muted small">10:45 AM</div>
                            </div>
                            <div class="timeline-item">
                                <div class="fw-bold">Order Sent to Kitchen</div>
                                <div class="text-muted small">10:47 AM</div>
                            </div>
                            <div class="timeline-item">
                                <div class="fw-bold">Food Preparation Started</div>
                                <div class="text-muted small">10:50 AM</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <h6>Order Items</h6>
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Price</th>
                                <th>Quantity</th>
                                <th>Subtotal</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Grilled Salmon</td>
                                <td>$18.99</td>
                                <td>1</td>
                                <td>$18.99</td>
                                <td><span class="badge bg-info">Preparing</span></td>
                            </tr>
                            <tr>
                                <td>Fresh Orange Juice</td>
                                <td>$4.99</td>
                                <td>2</td>
                                <td>$9.98</td>
                                <td><span class="badge bg-success">Delivered</span></td>
                            </tr>
                            <tr>
                                <td>Chocolate Cake</td>
                                <td>$7.99</td>
                                <td>1</td>
                                <td>$7.99</td>
                                <td><span class="badge bg-warning">Pending</span></td>
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <th colspan="3" class="text-end">Subtotal:</th>
                                <td>$36.96</td>
                                <td></td>
                            </tr>
                            <tr>
                                <th colspan="3" class="text-end">Tax (15%):</th>
                                <td>$5.54</td>
                                <td></td>
                            </tr>
                            <tr>
                                <th colspan="3" class="text-end">Service Charge (10%):</th>
                                <td>$3.70</td>
                                <td></td>
                            </tr>
                            <tr>
                                <th colspan="3" class="text-end">Total:</th>
                                <td class="fw-bold">$46.20</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <h6>Payment Information</h6>
                        <div class="alert alert-warning">
                            <i class="bi bi-exclamation-triangle me-2"></i> Payment not yet processed.
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h6>Actions</h6>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary">Update Status</button>
                            <button type="button" class="btn btn-outline-success">Process Payment</button>
                            <button type="button" class="btn btn-outline-danger">Cancel Order</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Print Receipt</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Order filter dropdown
        const filterLinks = document.querySelectorAll('.dropdown-item[data-filter]');
        filterLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active class from all links
                filterLinks.forEach(l => l.classList.remove('active'));
                
                // Add active class to clicked link
                this.classList.add('active');
                
                // Update dropdown button text
                const filter = this.dataset.filter;
                const buttonText = filter === 'all' ? 'All Orders' : this.textContent;
                document.getElementById('orderFilterDropdown').textContent = 'Filter: ' + buttonText;
                
                // Filter orders (would be AJAX in real implementation)
                console.log('Filtering by:', filter);
            });
        });
        
        // Add item button in new order form
        const addItemBtn = document.getElementById('addItemBtn');
        if (addItemBtn) {
            let itemCount = 1;
            
            addItemBtn.addEventListener('click', function() {
                itemCount++;
                const orderItems = document.getElementById('orderItems');
                
                const newItem = document.createElement('div');
                newItem.className = 'row mb-3 align-items-end order-item';
                newItem.innerHTML = `
                    <div class="col-md-5">
                        <label for="item${itemCount}" class="form-label">Item</label>
                        <select class="form-select" id="item${itemCount}" required>
                            <option value="">Select an item</option>
                            <option value="1">Grilled Salmon - $18.99</option>
                            <option value="2">Beef Steak - $22.99</option>
                            <option value="3">Cheese Platter - $10.99</option>
                            <option value="4">Chocolate Cake - $7.99</option>
                            <option value="5">Fresh Orange Juice - $4.99</option>
                        </select>
                        <div class="invalid-feedback">Please select an item.</div>
                    </div>
                    <div class="col-md-2">
                        <label for="quantity${itemCount}" class="form-label">Quantity</label>
                        <input type="number" class="form-control" id="quantity${itemCount}" min="1" value="1" required>
                        <div class="invalid-feedback">Quantity must be at least 1.</div>
                    </div>
                    <div class="col-md-4">
                        <label for="specialRequest${itemCount}" class="form-label">Special Request</label>
                        <input type="text" class="form-control" id="specialRequest${itemCount}" placeholder="Optional">
                    </div>
                    <div class="col-md-1">
                        <button type="button" class="btn btn-outline-danger remove-item">
                            <i class="bi bi-trash"></i>
                        </button>
                    </div>
                `;
                
                orderItems.appendChild(newItem);
                
                // Add event listener to new remove button
                const removeButtons = document.querySelectorAll('.remove-item');
                removeButtons.forEach(button => {
                    button.addEventListener('click', function() {
                        if (document.querySelectorAll('.order-item').length > 1) {
                            this.closest('.order-item').remove();
                            updateOrderTotal();
                        }
                    });
                });
            });
        }
        
        // Calculate order total
        function updateOrderTotal() {
            // In a real implementation, this would calculate the actual total based on selected items
            document.getElementById('orderTotal').textContent = '$45.80';
        }
        
        // Show order detail modal when clicking "View Details"
        const viewDetailLinks = document.querySelectorAll('a[href^="/orders/"]');
        viewDetailLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const orderId = this.getAttribute('href').split('/').pop();
                
                // Update modal title with order ID
                document.getElementById('orderDetailModalLabel').textContent = `Order #${orderId} Details`;
                
                // Show the modal
                const orderDetailModal = new bootstrap.Modal(document.getElementById('orderDetailModal'));
                orderDetailModal.show();
            });
        });
        
        // Form validation
        const forms = document.querySelectorAll('.needs-validation');
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                } else {
                    // For demo purposes, prevent actual form submission
                    event.preventDefault();
                    
                    // Show success message or redirect in a real implementation
                    if (form.id === 'newOrderForm') {
                        alert('Order created successfully!');
                        const modal = bootstrap.Modal.getInstance(document.getElementById('newOrderModal'));
                        modal.hide();
                    }
                }
                form.classList.add('was-validated');
            }, false);
        });
    });
</script>
{% endblock %}